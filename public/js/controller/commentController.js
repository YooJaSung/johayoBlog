angular.module('johayo.controller').controller('commentController',['$scope','commentService',function($scope,commentService){$scope.comment={};$scope.isShowEditor={};$scope.addComment=function(){commentService.addComment($scope.boardDetail._id,$scope.comment.content,$scope.comment.name,$scope.comment.pw).then(function(data){$scope.boardDetail=data;$scope.comment={};});};$scope.editComment=function(commentDetail){commentService.editComment($scope.boardDetail._id,commentDetail.seq,commentDetail.content,commentDetail.pw).then(function(data){$scope.closeEditor();$scope.boardDetail=data;$scope.showWriteBox=false;});};$scope.deleteComment=function(commentSeq,pw){commentService.deleteComment($scope.boardDetail._id,commentSeq,pw).then(function(data){$scope.boardDetail=data;});};$scope.checkVal=function(val){var checkContent=true;if(!!val.content){checkContent=val.content.replace(/(<([^>]+)>)/ig,"")==''}return checkContent||(!$scope.isLogin&&(!val.name||!val.pw));};$scope.showEditor=function(seq,subSeq){$scope.showWriteBox=true;if(!!subSeq){if(!$scope.isShowSubEditor[seq+'-'+subSeq]){$scope.closeEditor();$scope.isShowSubEditor[seq+'-'+subSeq]=true;}else{$scope.closeEditor();}}else{if(!$scope.isShowEditor[seq]){$scope.closeEditor();$scope.isShowEditor[seq]=true;}else{$scope.closeEditor();}}};$scope.closeEditor=function(){if(!!$scope.boardDetail.commentList){for(var i=0;i<$scope.boardDetail.commentList.length;i++){$scope.isShowEditor[$scope.boardDetail.commentList[i].seq]=false;}}};}]);