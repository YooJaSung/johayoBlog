angular.module('johayo.controller').controller('adminMenuController',['$rootScope','$scope','menuService','menuList',function($rootScope,$scope,menuService,menuList){$scope.menuList=menuList;$scope.menu={url:'/#/'};$scope.addMenu=function(){$scope.menu.url='/#/';if(!!$scope.menu.isBoard){$scope.menu.url=$scope.menu.url+'board/';}if(!$scope.menu.select){$scope.menu.url=$scope.menu.url+$scope.menu.name;menuService.addOneStepMenu($scope.menu).then(function(){$scope.getMenuList();});}else{$scope.menu.url=$scope.menu.url+$scope.menu.name;$scope.menu.oneStep_id=$scope.menu.select._id;menuService.addTwoStepMenu($scope.menu).then(function(){$scope.getMenuList();});}};$scope.getMenuList=function(){menuService.menuList=null;menuService.getMenuList().then(function(data){$scope.menuList=data;});$rootScope.$broadcast('getMenuList');};}]).controller('sideMenuController',['$rootScope','$scope','menuService','$location',function($rootScope,$scope,menuService,$location){$rootScope.$on("$routeChangeSuccess",function(){if(!!$scope.menuList){$scope.getActiveMenu();}else{$scope.getMenuList();}});$scope.getActiveMenu=function(){$scope.activeMenu='';$scope.activeSubMenu='';for(var i=0;i<$scope.menuList.length;i++){if($location.path().indexOf($scope.menuList[i].url.replace('/#/',''))>-1){$scope.activeMenu=$scope.menuList[i].name;}if($scope.menuList[i].subMenuList.length>0){for(var j=0;j<$scope.menuList[i].subMenuList.length;j++){if($location.path().indexOf($scope.menuList[i].subMenuList[j].url.replace('/#/',''))>-1){$scope.activeSubMenu=$scope.menuList[i].subMenuList[j].name;}}}}};$scope.moveActive=function(name){$scope.activeMenu=name;};$scope.isActive=function(name){return{'active':$scope.checkActive(name)}};$scope.checkActive=function(name){return $scope.activeMenu==name;};$scope.isSubActive=function(name){return{'active':$scope.activeSubMenu==name}};$scope.getClass=function(length){return{'sub-menu':length>0};};$scope.getMenuList=function(){menuService.getMenuList().then(function(data){$scope.menuList=data;$scope.getActiveMenu();});};$rootScope.$on('getMenuList',function(){$scope.getMenuList();});}]);